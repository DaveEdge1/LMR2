--- a/2_make_maps_and_ts.py
+++ b/2_make_maps_and_ts.py
@@ -935,7 +935,22 @@ Regional time series section:
     else:
         # Make a mask for the different regions
-        mask_3D = ar6_all.mask_3D(lon,lat)
+        # Handle CFR/LMR data with wrapped longitude coordinates (0-360)
+        # regionmask fails if lon has duplicate values at boundaries
+        try:
+            mask_3D = ar6_all.mask_3D(lon, lat)
+        except ValueError as e:
+            if "equal longitude coordinates" in str(e):
+                # Remove the last longitude point if it's a duplicate of the first
+                # This happens when lon is [0, ..., 360] or [-180, ..., 180]
+                print(f'Warning: Longitude coordinates appear to wrap. Removing last point.')
+                print(f'  Original lon range: {lon[0]} to {lon[-1]}')
+                lon_adjusted = lon[:-1]
+                print(f'  Adjusted lon range: {lon_adjusted[0]} to {lon_adjusted[-1]}')
+                mask_3D = ar6_all.mask_3D(lon_adjusted, lat)
+                # Also need to slice the spatial data to match
+                var_spatial_mean = var_spatial_mean[:,:,:,:-1]
+            else:
+                raise

         # Make a 2D lat/lon grid
         lon_2d,lat_2d = np.meshgrid(lon,lat)
